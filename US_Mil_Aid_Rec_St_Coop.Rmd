---
title: "US_Mil_Aid_Rec_St_Coop"
author: "Daniel Shapiro"
date: "1/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(tidyverse)
library(readr)
library(readxl)
library(stringr)
library(data.table)
```

# Data read-in

```{r data readin}
load("Dataset-Military-Aid-and-Recipient-State-Cooperation-091310 (4).RData")
x <- as_data_frame(x)

import <- read_csv("TIV-Import-All-2000-2019.csv", col_types = cols(
  .default = col_double(),
  Country = col_character()
))

usa <- read_csv("TIV-Export-USA-2000-2019.csv", col_types = cols(
  .default = col_double(),
  Country = col_character()
))

russia <- read_csv("TIV-Export-RUS-2000-2019.csv", col_types = cols(
  .default = col_double(),
  Country = col_character()
))

russia <- russia[-92, ]
usa <- usa[-130, ]
import <- import[-201, ]

russia <- russia %>% pivot_longer(`2000`:`2019`, names_to = "Year", values_to = "Russia") %>%
  select(-Total)

usa <- usa %>% pivot_longer(`2000`:`2019`, names_to = "Year", values_to = "USA") %>%
  select(-Total)

import <- import %>% pivot_longer(`2000`:`2019`, names_to = "Year", values_to = "Full") %>%
  select(-Total)

data <- merge(russia, usa, by = c("Country", "Year"), all = TRUE)
data[is.na(data)] <- 0

fulldata <- merge(data, import, by = c("Country", "Year"), all = TRUE)
fulldata[is.na(fulldata)] <- 0
```

# Full data column setup

```{r}
fulldata <- fulldata %>% 
  mutate(RussiaPct = Russia/Full*100) %>%
  mutate(USPct = USA/Full*100)
fulldata[is.na(fulldata)] <- 0
```

# Finding Countries in Last 5 years with Presence of Both Russia and USA

```{r}
recent <- fulldata %>%
  filter(Year %in% c("2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019"))  %>%
  filter(RussiaPct >= 2) %>%
  filter(USPct >= 2)
```

```{r}
recent <- recent[-c(72:81), ]
```

```{r}
recent
```

# Filtering Countries from previous category into U.S. aid data (dataframe x); writing to new CSV for further use in Excel

```{r}
specific <- x %>% filter(ccodesrc %in% c(692, 771, 140, 651, 750, 645, 663, 690, 475, 770, 135, 800, 640, 696, 704))

specific <- specific[ ,1:19]

# You don't need to do this; I just did this so that I could add data in Excel rather than in R. I will read in the updated CSV in the next code chunk and label it something different to avoid confusion. 

write.csv(specific, "specific.csv", row.names = FALSE)
```

# Opening and Reading in Polity V Scores

```{r}
polity <- read_xls("p5v2018.xls") 
```

```{r}
polity <- polity %>%
  filter(year %in% c("1990", "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000", "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018")) %>%
  filter(country %in% c("Peru", "Brazil", "Nigeria", "Turkey", "Iraq", "Egypt", "Jordan", "Kuwait", "Bahrain", "UAE", "Uzbekistan", "India", "Pakistan", "Bangladesh", "Thailand")) %>%
  select(c(country, year, polity2))

write.csv(polity, "polity.csv", row.names = FALSE)
```

